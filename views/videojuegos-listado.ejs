<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h2 fw-bold text-dark">Mis Videojuegos</h1>
  <a href="/videojuegos/nuevo" class="btn btn-primary shadow-sm">
      <i class="bi bi-plus-lg me-2"></i>Añadir Juego
  </a>
</div>

<div class="card border-0 shadow-sm mb-4">
  <div class="card-body">
      <form class="row g-3" method="get" action="/admin">
          <div class="col-md-4">
              <select class="form-select border-0 bg-light" name="plataforma">
                  <option value="">Todas las Plataformas</option>
                  <option value="PC" <%= filtro.plataforma === "PC" ? "selected" : "" %>>PC</option>
                  <option value="PlayStation" <%= filtro.plataforma === "PlayStation" ? "selected" : "" %>>PlayStation</option>
                  <option value="Xbox" <%= filtro.plataforma === "Xbox" ? "selected" : "" %>>Xbox</option>
                  <option value="Nintendo" <%= filtro.plataforma === "Nintendo" ? "selected" : "" %>>Nintendo</option>
              </select>
          </div>
          <div class="col-md-6">
              <button type="submit" class="btn btn-dark px-4">Filtrar</button>
              <a href="/admin" class="btn btn-link text-decoration-none text-muted">Limpiar</a>
          </div>
      </form>
  </div>
</div>

<% if (videojuegos.length === 0) { %>
  <div class="text-center py-5">
      <i class="bi bi-controller fs-1 text-muted"></i>
      <p class="mt-3 text-muted">No tienes juegos en tu colección aún.</p>
  </div>
<% } else { %>

  <div class="d-none d-md-block card border-0 shadow-sm overflow-hidden">
      <table class="table table-hover align-middle mb-0">
          <thead class="bg-light">
              <tr>
                  <th class="ps-4">Juego</th>
                  <th>Plataforma</th>
                  <th>Género</th>
                  <th>Estado</th>
                  <th class="text-end pe-4">Acciones</th>
              </tr>
          </thead>
          <tbody>
              <% videojuegos.forEach(function(v) { %>
              <tr>
                  <td class="ps-4">
                      <div class="d-flex align-items-center">
                          <img src="<%= v.imagen || 'https://via.placeholder.com/150' %>" 
                               class="rounded me-3 shadow-sm" 
                               style="width: 50px; height: 50px; object-fit: cover;">
                          <span class="fw-bold"><%= v.titulo %></span>
                      </div>
                  </td>
                  <td><span class="badge bg-light text-dark border"><%= v.plataforma %></span></td>
                  <td><%= v.genero %></td>
                  <td>
                      <span class="badge rounded-pill <%= v.estado === 'completado' ? 'bg-success' : (v.estado === 'progreso' ? 'bg-warning text-dark' : 'bg-secondary') %>">
                          <%= v.estado %>
                      </span>
                  </td>
                  <td class="text-end pe-4">
                      <a href="/videojuegos/<%= v.id %>/editar" class="btn btn-sm btn-outline-primary border-0"><i class="bi bi-pencil-square"></i></a>
                      <form action="/videojuegos/<%= v.id %>/borrar" method="post" class="d-inline">
                          <button type="submit" class="btn btn-sm btn-outline-danger border-0" onclick="return confirm('¿Borrar juego?')"><i class="bi bi-trash"></i></button>
                      </form>
                  </td>
              </tr>
              <% }); %>
          </tbody>
      </table>
  </div>

  <div class="d-md-none row g-3">
      <% videojuegos.forEach(function(v) { %>
      <div class="col-12">
          <div class="card border-0 shadow-sm h-100 overflow-hidden">
              <img src="<%= v.imagen || 'https://via.placeholder.com/400x200' %>" 
                   class="card-img-top" style="height: 180px; object-fit: cover;">
              <div class="card-body bg-white">
                  <div class="d-flex justify-content-between align-items-start mb-2">
                      <h5 class="card-title fw-bold mb-0"><%= v.titulo %></h5>
                      <span class="badge bg-primary"><%= v.plataforma %></span>
                  </div>
                  <p class="text-muted small mb-3"><%= v.genero %> • <span class="text-capitalize"><%= v.estado %></span></p>
                  <div class="d-flex gap-2">
                      <a href="/videojuegos/<%= v.id %>/editar" class="btn btn-light flex-grow-1 border">Editar</a>
                      <form action="/videojuegos/<%= v.id %>/borrar" method="post" class="flex-grow-1">
                          <button type="submit" class="btn btn-outline-danger w-100">Borrar</button>
                      </form>
                  </div>
              </div>
          </div>
      </div>
      <% }); %>
  </div>

<% } %>